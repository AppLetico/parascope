# PRD: {{ pr_title }}

> **Repository:** {{ repo_name }}
> **PR:** [#{{ pr_number }}]({{ pr_url }})
> **Author:** {{ pr_author }}
> **Status:** {{ pr_state }}{% if pr_merged_at %} (merged {{ pr_merged_at }}){% endif %}

{% if llm_analysis and llm_analysis.relevance %}
> **Recommendation:** {{ llm_analysis.relevance.decision | upper }} ({{ "%.0f" | format(llm_analysis.relevance.confidence * 100) }}% confidence)
{% else %}
> **Relevance Score:** {{ "%.2f"|format(final_score) }} | **Decision:** {{ decision }}
{% endif %}
> **Evaluated:** {{ evaluated_at }}

---

## Summary

{{ pr_body_summary }}

{% if pr_labels %}
**Labels:** {% for label in pr_labels %}`{{ label }}`{% if not loop.last %}, {% endif %}{% endfor %}

{% endif %}

{% if llm_analysis and llm_analysis.relevance %}
---

## AI Analysis

### Recommendation: {{ llm_analysis.relevance.decision | upper }}

**Confidence:** {{ "%.0f" | format(llm_analysis.relevance.confidence * 100) }}%

**Reasoning:** {{ llm_analysis.relevance.reasoning }}

{% if llm_analysis.relevance.already_implemented %}
**Warning:** Similar functionality may already exist in your codebase (overlap: {{ llm_analysis.relevance.implementation_overlap }})
{% endif %}

{% if llm_analysis.why_this_matters %}
### Why This Matters

{{ llm_analysis.why_this_matters }}
{% endif %}

{% if llm_analysis.estimated_effort %}
**Estimated Effort:** {{ llm_analysis.estimated_effort }}
{% endif %}

{% endif %}
---

## Relevance to Local Codebase

This PR matches **{{ matched_features|length }}** feature(s) in your codebase.

{% if feature_matches %}
| Feature | Keywords | Paths |
|---------|----------|-------|
{% for match in feature_matches %}
| **{{ match.name }}** | {{ match.keywords|join(", ") or "-" }} | {{ match.paths|join(", ") or "-" }} |
{% endfor %}
{% else %}
*No direct feature matches found.*
{% endif %}

### Scoring Breakdown

- **Rule Score:** {{ "%.2f"|format(rule_score) }}
- **Final Score:** {{ "%.2f"|format(final_score) }}
- **Files Changed:** {{ file_count }}
- **Total Additions:** +{{ total_additions }}
- **Total Deletions:** -{{ total_deletions }}

---

## Files Changed

{% if files %}
| File | Changes |
|------|---------|
{% for file in files %}
| `{{ file.path }}` | +{{ file.additions }} / -{{ file.deletions }} |
{% endfor %}
{% if file_count > 20 %}

*... and {{ file_count - 20 }} more files*
{% endif %}
{% else %}
*No files changed.*
{% endif %}

---

## Proposed Implementation

{% if llm_analysis and llm_analysis.implementation_plan %}
{{ llm_analysis.implementation_plan }}
{% else %}
Based on the PR changes, consider the following implementation approach:

1. **Review the PR changes** - Understand the modifications made in the upstream repository
2. **Identify applicable patterns** - Determine which changes are relevant to your codebase
3. **Adapt to local context** - Modify the approach to fit your architecture and conventions
4. **Incremental integration** - Implement changes in small, testable increments

### Key Files to Consider

{% for match in feature_matches %}
- Files matching **{{ match.name }}**: {{ match.paths|join(", ") or "Review PR files" }}
{% endfor %}
{% endif %}

---

## Acceptance Criteria

{% if llm_analysis and llm_analysis.tests %}
{% for test in llm_analysis.tests %}
- [ ] {{ test }}
{% endfor %}
{% else %}
- [ ] Changes are compatible with existing codebase architecture
- [ ] All existing tests continue to pass
- [ ] New functionality is covered by appropriate tests
- [ ] Documentation is updated if applicable
- [ ] Code review completed by team member
{% endif %}

---

## Test Plan

{% if llm_analysis and llm_analysis.tests %}
### Recommended Tests

{% for test in llm_analysis.tests %}
- {{ test }}
{% endfor %}
{% else %}
### Recommended Testing Approach

1. **Unit Tests** - Test individual components affected by changes
2. **Integration Tests** - Verify interactions between modified components
3. **Regression Tests** - Ensure existing functionality is not broken
4. **Manual Testing** - Validate user-facing features if applicable
{% endif %}

---

## Risks and Considerations

{% if llm_analysis and llm_analysis.risks %}
{% for risk in llm_analysis.risks %}
- {{ risk }}
{% endfor %}
{% else %}
- **Breaking Changes** - Review for any API or interface changes that may affect consumers
- **Performance** - Consider performance implications of the changes
- **Security** - Evaluate security implications, especially for authentication/authorization changes
- **Dependencies** - Check for any new dependencies or version requirements
- **Migration** - Determine if any data or configuration migration is needed
{% endif %}

{% if llm_analysis and llm_analysis.impacted_features %}
---

## Impacted Features

{% for feature in llm_analysis.impacted_features %}
- {{ feature }}
{% endfor %}
{% endif %}

---

## References

- **Pull Request:** [{{ repo_name }}#{{ pr_number }}]({{ pr_url }})
- **Head SHA:** `{{ pr_head_sha }}`
- **Files Changed:** {{ file_count }}
- **Evaluation ID:** {{ evaluation_id }}
- **Local Profile SHA:** `{{ local_profile_sha }}`

---

*Generated by [Parascope](https://github.com/appletico/parascope) on {{ evaluated_at }}*
